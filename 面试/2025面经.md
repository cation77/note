---
title: 2025 面经
---

## 前端如何实现截图

1. 使用 `html2canvas`
2. 使用 `dom-to-image`
3. 使用 `canvas` API

```javascript
// 方法一：
// 使用 html2canvas 带水印的截图
html2canvas(document.body, {
  allowTaint: true,       // 允许跨域图像
  useCORS: true,          // 使用CORS加载跨域资源
  scale: 2,               // 提高分辨率（防模糊）
  logging: false          // 关闭日志
}).then(canvas => {
  const ctx = canvas.getContext('2d');
  // 添加水印文本
  ctx.font = '20px Arial';
  ctx.fillStyle = 'rgba(255,0,0,0.5)';
  ctx.fillText('Confidential', 20, canvas.height - 30);
  
  // 导出并下载
  const link = document.createElement('a');
  link.download = 'screenshot-with-watermark.png';
  link.href = canvas.toDataURL();
  link.click();
});

// 方法二：Canvas API（简单场景）
// 截取<img>元素内容
const img = document.getElementById('target-image');
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');

canvas.width = img.width;
canvas.height = img.height;
ctx.drawImage(img, 0, 0);

// 导出为DataURL
const dataURL = canvas.toDataURL('image/jpeg', 0.8);
```

## [当QPS达到峰值时,该如何处理?](./QPS峰值处理.md)

当系统QPS（每秒查询率）达到峰值时，需要从前端到后端全链路优化，结合限流、降级、扩容等手段保障系统稳定。

## js 超过 Number 最大值的数怎么处理

1. 使用 BigInt
2. 字符串处理（简单场景），仅需存储或传输大数，不进行数学运算
3. 使用第三方库
   - bignumber.js：用于处理任意精度的数字
   - ecimal.js：提供高精度的十进制运算
  
## js实现大数相加

```JavaScript
function addBigNumbers(num1, num2) {
    let carry = 0; // 进位
    let result = '';
    
    // 将两个数字反转，使得从最低位开始相加
    num1 = num1.split('').reverse();
    num2 = num2.split('').reverse();
    
    const maxLength = Math.max(num1.length, num2.length);
    
    for (let i = 0; i < maxLength; i++) {
        const digit1 = parseInt(num1[i] || '0', 10); // 获取第 i 位数字
        const digit2 = parseInt(num2[i] || '0', 10); // 获取第 i 位数字
        
        const sum = digit1 + digit2 + carry; // 当前位的和
        result += sum % 10; // 当前位的结果
        carry = Math.floor(sum / 10); // 更新进位
    }
    
    // 如果还有进位，添加到结果中
    if (carry) {
        result += carry;
    }
    
    // 反转结果并返回
    return result.split('').reverse().join('');
}

// 示例
const num1 = "123456789012345678901234567890";
const num2 = "987654321098765432109876543210";
console.log(addBigNumbers(num1, num2)); // 输出：1111111110111111111011111111100
```

## 使用同一个链接，如何实现 PC 打开是 web 应用、手机打开是一个 H5 应用?

### 方案1：服务端动态渲染（推荐）

> 服务端（如Node.js、Nginx）检测设备类型 → 返回对应HTML模板
> SEO友好，首屏加载性能更优

- Node.js + Express 示例

```javascript
const express = require('express');
const mobileDetect = require('mobile-detect');
const app = express();

// 中间件：检测设备类型
app.use((req, res, next) => {
  const md = new mobileDetect(req.headers['user-agent']);
  req.isMobile = !!md.mobile(); // 判断是否为移动设备
  next();
});

// 路由：根据设备返回不同页面
app.get('/', (req, res) => {
  if (req.isMobile) {
    res.sendFile(__dirname + '/mobile/index.html'); // H5页面
  } else {
    res.sendFile(__dirname + '/pc/index.html');     // PC页面
  }
});

app.listen(3000);
```

- Nginx配置示例

```Nginx
server {
  listen 80;
  server_name example.com;

  # 设备检测（基于User-Agent）
  set $device "pc";
  if ($http_user_agent ~* "(android|iphone|ipod|ipad|mobile)") {
    set $device "mobile";
  }

  # 根据设备类型返回不同根目录
  location / {
    root /var/www/$device;
    try_files $uri $uri/ /index.html;
  }
}
```

### 方案2：客户端动态加载（SPA适用）

> 前端根据设备类型动态加载不同组件，使用正则表达式检查 `navigator.userAgent` 字符串

```javascript
// React 示例
import React, { useEffect, useState } from 'react';
import PCVersion from './PCVersion';
import MobileVersion from './MobileVersion';

const App = () => {
  const [isMobile, setIsMobile] = useState(false);

  // 检测设备类型（组件挂载时）
  useEffect(() => {
    const checkDevice = () => {
      const mobileRegex = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;
      setIsMobile(mobileRegex.test(navigator.userAgent));
    };
    checkDevice();
    window.addEventListener('resize', checkDevice);
    return () => window.removeEventListener('resize', checkDevice);
  }, []);

  return isMobile ? <MobileVersion /> : <PCVersion />;
};

export default App;

// Vue 示例

<template>
  <component :is="currentView" />
</template>

<script>
import PCVersion from './PCVersion.vue';
import MobileVersion from './MobileVersion.vue';

export default {
  data() {
    return {
      isMobile: false
    };
  },
  computed: {
    currentView() {
      return this.isMobile ? MobileVersion : PCVersion;
    }
  },
  mounted() {
    this.checkDevice();
    window.addEventListener('resize', this.checkDevice);
  },
  beforeDestroy() {
    window.removeEventListener('resize', this.checkDevice);
  },
  methods: {
    checkDevice() {
      const ua = navigator.userAgent;
      this.isMobile = /iPhone|iPad|iPod|Android|Mobile/i.test(ua);
    }
  }
};
</script>
```

## 参考

1. [前端面试题](https://maimai.cn/article/detail?fid=1853419102&efid=2VPZyK6a830IyBz2rW1aiQ)
